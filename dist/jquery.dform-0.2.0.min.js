(function(a){var h={},k={},b=a.each,e=a.isArray,g=function(c,d,f){if(typeof d=="string"){e(c[d])||(c[d]=[]);c[d].push(f)}else typeof d=="object"&&b(d,function(i,j){g(c,i,j)})};a.fn.extend({runSubscription:function(c,d,f){a.dform.hasSubscription(c)&&this.each(function(){var i=this;b(h[c],function(j,l){l.call(a(i),d,f)})});return this},runAll:function(c){var d=c.type,f=this;this.runSubscription("[pre]",c,d);b(c,function(i,j){a(f).runSubscription(i,j,d)});this.runSubscription("[post]",c,d);return this},
formElement:function(c,d){if(d&&a.dform.converters&&a.dform.converters[d])c=a.dform.converters[d](c);d=a.dform.createElement(c);this.append(a(d));a(d).runAll(c);return this},buildForm:function(c,d,f){if(typeof c=="string"){var i=a(this);a.get(c,d,function(j,l,m){a(i).buildForm(j);a.isFunction(f)&&f(j,l,m)},a.dform.options.ajaxFormat)}else{c.type||(c=a.extend({type:"form"},c));if(this.is(c.type)){this.dformAttr(c);this.runAll(c)}else this.formElement(c,d)}return this},dformAttr:function(c,d){var f=
a.keyset(h);a.isArray(d)&&a.merge(f,d);this.attr(a.withoutKeys(c,f));return this}});a.extend(a,{keyset:function(c){var d=[];b(c,function(f){d.push(f)});return d},withKeys:function(c,d){var f={};b(d,function(i,j){if(c[j])f[j]=c[j]});return f},withoutKeys:function(c,d){var f={};b(c,function(i,j){if(a.inArray(i,d)==-1)f[i]=j});return f},getValueAt:function(c,d){d=e(d)?d:d.split(".");c=c;for(var f=0;f<d.length;f++){var i=d[f];if(!c[i])return false;c=c[i]}return c}});a.dform={options:{prefix:"ui-dform-",
ajaxFormat:"json"},defaultType:function(c){return a("<"+c.type+">").dformAttr(c)},removeType:function(c){delete k[c]},typeNames:function(){return a.keyset(k)},addType:function(c,d){g(k,c,d)},addTypeIf:function(c,d,f){c&&a.dform.addType(d,f)},subscriberNames:function(){return a.keyset(h)},subscribe:function(c,d){g(h,c,d)},subscribeIf:function(c,d,f){c&&a.dform.subscribe(d,f)},removeSubscription:function(c){delete h[c]},hasSubscription:function(c){return h[c]?true:false},createElement:function(c){var d=
c.type;if(!d)throw"No element type given! Must always exist.";var f=null;if(k[d]){var i=a.withoutKeys(c,["type"]);b(k[d],function(j,l){f=l.call(f,i)})}else f=a.dform.defaultType(c);return a(f)}}})(jQuery);
(function(a){var h=function(b,e){return function(g){return a(b).dformAttr(g,e)}},k=a.each;a.dform.addType({container:h("<div>"),form:h("<form>"),text:h('<input type="text" />'),password:h('<input type="password" />'),submit:h('<input type="submit" />'),reset:h('<input type="reset" />'),hidden:h('<input type="hidden" />'),radio:h('<input type="radio" />'),checkbox:h('<input type="checkbox" />'),checkboxes:h("<div>",["name"]),radiobuttons:h("<div>",["name"]),file:h('<input type="file" />'),number:h('<input type="number" />'),
url:h('<input type="url" />'),tel:h('<input type="tel" />'),email:h('<input type="email" />')});a.dform.subscribe({"class":function(b){this.addClass(b)},html:function(b){this.html(b)},elements:function(b){var e=a(this);k(b,function(g,c){if(typeof g=="string")c.name=name;a(e).formElement(c)})},value:function(b){this.val(b)},css:function(b){this.css(b)},options:function(b,e){var g=a(this);if(e=="select"||e=="optgroup")k(b,function(c,d){var f={type:"option"};if(typeof d=="string"){f.value=c;f.html=d}if(typeof d==
"object")f=a.extend(f,d);a(g).formElement(f)});else if(e=="checkboxes"||e=="radiobuttons"){g=this;k(b,function(c,d){var f=e=="radiobuttons"?{type:"radio"}:{type:"checkbox"};if(typeof d=="string")f.caption=d;else a.extend(f,d);f.value=c;a(g).formElement(f)})}},caption:function(b,e){var g={};if(typeof b=="string")g.html=b;else a.extend(g,b);if(e=="fieldset"){g.type="legend";e=a.dform.createElement(g);this.prepend(e);a(e).runAll(g)}else{g.type="label";if(this.attr("id"))g["for"]=this.attr("id");b=a.dform.createElement(g);
e=="checkbox"||e=="radio"?this.parent().append(a(b)):a(b).insertBefore(a(this));a(b).runAll(g)}},type:function(b,e){a.dform.options.prefix&&this.addClass(a.dform.options.prefix+e)},url:function(b){this.buildForm(b)},"[post]":function(b,e){if(e=="checkboxes"||e=="radiobuttons")this.children("[type="+(e=="checkboxes"?"checkbox":"radio")+"]").each(function(){a(this).attr("name",b.name)})}})})(jQuery);
(function(a){function h(b,e){b=a.keyset(a.ui[b].prototype.options);return a.withKeys(e,b)}function k(b){if(a.isFunction(b.split)){b=b.split(".");if(b.length>1){var e=b.shift();if(e=jQuery.global.localize(e))return a.getValueAt(e,b)}}return false}a.dform.addTypeIf(a.isFunction(a.fn.progressbar),"progressbar",function(b){return a("<div>").dformAttr(b).progressbar(h("progressbar",b))});a.dform.addTypeIf(a.isFunction(a.fn.slider),"slider",function(b){return a("<div>").dformAttr(b).slider(h("slider",b))});
a.dform.addTypeIf(a.isFunction(a.fn.accordion),"accordion",function(b){return a("<div>").dformAttr(b)});a.dform.addTypeIf(a.isFunction(a.fn.tabs),"tabs",function(b){return a("<div>").dformAttr(b)});a.dform.subscribeIf(a.isFunction(a.fn.accordion),"entries",function(b,e){if(e=="accordion"){var g=this;a.each(b,function(c,d){c=a.extend({type:"div"},d);a(g).formElement(c);if(d.caption){d=a(g).children("div:last").prev();d.replaceWith('<h3><a href="#">'+d.html()+"</a></h3>")}})}});a.dform.subscribeIf(a.isFunction(a.fn.tabs),
"entries",function(b,e){if(e=="tabs"){var g=this;this.append("<ul>");var c=a(g).children("ul:first");a.each(b,function(d,f){d=f.id?f.id:d;a.extend(f,{type:"container",id:d});a(g).formElement(f);f=a(g).children("div:last").prev();a(f).wrapInner(a("<a>").attr("href","#"+d));a(c).append(a("<li>").wrapInner(f))})}});a.dform.subscribeIf(a.isFunction(a.fn.dialog),"dialog",function(b,e){if(e=="form"||e=="fieldset")this.dialog(b)});a.dform.subscribeIf(a.isFunction(a.fn.resizable),"resizable",function(b){this.resizable(b)});
a.dform.subscribeIf(a.isFunction(a.fn.datepicker),"datepicker",function(b,e){e=="text"&&this.datepicker(b)});a.dform.subscribeIf(a.isFunction(a.fn.autocomplete),"autocomplete",function(b,e){e=="text"&&this.autocomplete(b)});a.dform.subscribe("[post]",function(b,e){if(this.parents("form").hasClass("ui-widget")){if((e=="button"||e=="submit")&&a.isFunction(a.fn.button))this.button();a.inArray(e,["text","textarea","password","fieldset"])!=-1&&this.addClass("ui-widget-content ui-corner-all")}if(e=="accordion"||
e=="tabs")this[e](h(e,b))});a.dform.subscribeIf(a.isFunction(a.fn.validate),{"[pre]":function(b,e){if(e=="form"){e={};if(this.hasClass("ui-widget"))e={highlight:function(g){a(g).addClass("ui-state-highlight")},unhighlight:function(g){a(g).removeClass("ui-state-highlight")}};typeof b.validate=="object"&&a.extend(e,b.validate);this.validate(e)}},validate:function(b,e){e!="form"&&this.rules("add",b)}});a.dform.subscribeIf(a.isFunction(a.fn.ajaxForm),"ajax",function(b,e){e=="form"&&this.ajaxForm(b)});
a.dform.subscribeIf(a.global&&a.isFunction(a.global.localize),"html",function(b){(b=k(b))&&a(this).html(b)});a.dform.subscribeIf(a.global,"options",function(b,e){if(e=="select"&&typeof b=="string"){a(this).html("");(b=k(b))&&a(this).runSubscription("options",b,e)}});a.dform.subscribeIf(a.isFunction(a.fn.wysiwyg),"wysiwyg",function(){})})(jQuery);
